<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Type Ahead ğŸ‘€</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <form class="search-form">
    <input type="text" class="search" placeholder="City or State">
    <ul class="suggestions">
      <li>Filter for a city</li>
      <li>or a state</li>
    </ul>
  </form>
  <script>
    const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';
    const list = document.querySelector('form ul');
    const input = document.querySelector('input');
    const city_population = [[], []]; //åŸå¸‚+äººå£

    fetch(endpoint)
      .then(function (response) {
        // console.log(response.json());  å¦‚æœé€™é‚Šå…ˆlogä¸€æ¬¡ï¼Œå†ç”¨returnå°±æœƒå£æ‰ï¼Œåªèƒ½å‘¼å«ä¸€æ¬¡
        return response.json();
      })
      .catch(function (error) { //å°šé ˆç¢ºå®šé€™å€‹è¦æ”¾å“ªè£¡
        console.log(error);
      })
      .then(function (myJson) {
        // console.log(myJson);
        Object.values(myJson).forEach(element => { //å°‡ç‰©ä»¶è½‰æ›ç‚ºé™£åˆ—åŠ ä»¥ç”¨foreach
          city_population[0].push(`${element.city}, ${element.state}`);//åœ¨é€™é‚ŠæŠŠå·èˆ‡åŸå¸‚ç›´æ¥çµåˆ
          city_population[1].push(element.population.replace(/\B(?=(\d{3})+(?!\d))/g, ','));
          // city_population[2].push(element.state);
        });
      });

      console.log(city_population);
      input.addEventListener('input',comparison);

      function comparison(){
        list.innerHTML = ""; //åˆå§‹åŒ–æŠŠæ¨™ç±¤éƒ½æ¸…æ‰
        city_population[0].forEach(function(city,index){
          // ç¶²å‹æä¾›ä¸€å€‹å¾ˆå¥½çš„æ–¹æ³•ï¼Œè¦ä¸å€åˆ†å¤§å°å¯«çš„è©±ï¼Œå°±å…ˆæŠŠå…©é‚Šå…¨éƒ¨éƒ½è½‰æˆå¤§å¯«æˆ–å°å¯«åœ¨ä¾†æ¯”è¼ƒå°±å¥½å•¦~ è½‰æˆå¤§å¯«toUpperCase()ï¼Œè½‰æˆå°å¯«toLowerCase()
          if((String(city).toLowerCase()).match(input.value.toLowerCase())){
            let text = (String(city).toLowerCase()).match(input.value.toLowerCase()).index;
            console.log(text);

            // console.log(city);
            // console.log(index);
            // console.log(city_population[1][index]);
            list.innerHTML += 
            `
              <li>
              <span>${city}</span>
              <span class="population">${city_population[1][index]}</span>
              </li>
            `;


          }
        });
      }

  </script>
</body>

</html>

<!-- å‰©ä¸‹ä¸æœƒè®Šè‰²ä½†æ˜¯åšä¸å‡ºä¾†äº†å› ç‚ºæˆ‘ä¸æ˜¯ç”¨æ­£å‰‡ -->
<!-- å•é¡Œï¼šå› ç‚ºæ¯ç•¶è¼¸å…¥ä¸€å€‹å­—å°±è¦é‡æ–°è·‘ä¸€åƒæ¬¡è¿´åœˆæ‰€ä»¥è³‡æ–™éå¸¸ç·©æ…¢ -->